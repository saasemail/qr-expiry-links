<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TempQR — Feedback</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <nav class="navbar">
    <div class="nav-left">
      <span class="brand-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" width="22" height="22" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3 3h8v8H3V3Zm2 2v4h4V5H5Zm8-2h8v8h-8V3Zm2 2v4h4V5h-4ZM3 13h8v8H3v-8Zm2 2v4h4v-4H5Zm10 0h2v2h-2v-2Zm2 2h2v2h-2v-2Zm-2 2h2v2h-2v-2Zm4-6h2v6h-2v-6Z" fill="currentColor"/>
        </svg>
      </span>
      <h1 class="brand-name">TempQR</h1>
    </div>

    <div class="nav-links">
      <a href="index.html" rel="nofollow">Home</a>
      <a href="faq.html" rel="nofollow">FAQ</a>
    </div>
  </nav>

  <main class="page">
    <header class="page-hero">
      <h2 class="page-title">We’d love your feedback</h2>
      <p class="page-subtitle">Share ideas, report bugs, or tell us what to improve.</p>
    </header>

    <section class="page-card">
      <div class="prose">
        <form id="feedbackForm" novalidate>
          <label for="msg">
            Your Message <span aria-hidden="true">*</span>
            <textarea
              id="msg"
              name="msg"
              rows="8"
              required
              placeholder="Write your message here..."
              style="resize: vertical;"
            ></textarea>
          </label>

          <label for="email" style="margin-top: 0.75rem;">
            Email (optional)
            <input
              id="email"
              name="email"
              type="email"
              inputmode="email"
              autocomplete="email"
              placeholder="you@example.com"
            />
          </label>

          <p class="muted" style="margin: 0.5rem 0 0;">
            We’ll only use this email to follow up on your message.
          </p>

          <div class="feedback-actions" style="margin-top: 1rem;">
            <button class="btn btn-primary" id="submitBtn" type="submit">Submit Feedback</button>
            <button class="btn btn-ghost" id="copyBtn" type="button">Copy message</button>
          </div>

          <p class="muted" id="status" style="margin-top: 0.9rem; display:none;"></p>

          <p class="muted" style="margin-top: 1rem;">
            Tip: include the expiring link you created and what device/app you used (Chrome, Safari, Messenger, Viber, etc.).
          </p>

          <!-- Hidden support address (easy to change later) -->
          <input type="hidden" id="supportTo" value="support@tempqr.com" />
        </form>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="footer-left">© TempQR</div>
    <div class="footer-links">
      <a href="terms.html" rel="nofollow">Terms</a>
      <a href="privacy.html" rel="nofollow">Privacy</a>
      <a href="faq.html" rel="nofollow">FAQ</a>
      <a href="feedback.html" rel="nofollow">Feedback</a>
    </div>
  </footer>

  <script>
    (function () {
      const form = document.getElementById("feedbackForm");
      const msg = document.getElementById("msg");
      const email = document.getElementById("email");
      const status = document.getElementById("status");
      const copyBtn = document.getElementById("copyBtn");
      const supportTo = document.getElementById("supportTo");

      function showStatus(text) {
        if (!status) return;
        status.textContent = text;
        status.style.display = "block";
        window.clearTimeout(showStatus._t);
        showStatus._t = window.setTimeout(() => { status.style.display = "none"; }, 2600);
      }

      function buildPayload() {
        const message = (msg.value || "").trim();
        const fromEmail = (email.value || "").trim();

        const lines = [];
        lines.push("TempQR Feedback");
        lines.push("");
        if (fromEmail) lines.push("Reply email: " + fromEmail);
        lines.push("Message:");
        lines.push(message);
        lines.push("");
        lines.push("----");
        lines.push("Meta:");
        try {
          lines.push("User agent: " + navigator.userAgent);
        } catch (e) {}
        try {
          lines.push("Time: " + new Date().toISOString());
        } catch (e) {}

        return { message, fromEmail, body: lines.join("\n") };
      }

      async function copyText(text) {
        try {
          if (navigator.clipboard && navigator.clipboard.writeText) {
            await navigator.clipboard.writeText(text);
            return true;
          }
        } catch (e) {}

        // fallback
        try {
          const ta = document.createElement("textarea");
          ta.value = text;
          ta.setAttribute("readonly", "");
          ta.style.position = "absolute";
          ta.style.left = "-9999px";
          document.body.appendChild(ta);
          ta.select();
          document.execCommand("copy");
          document.body.removeChild(ta);
          return true;
        } catch (e) {
          return false;
        }
      }

      copyBtn.addEventListener("click", async function () {
        const { message, body } = buildPayload();
        if (!message) {
          showStatus("Please write a message first.");
          msg.focus();
          return;
        }
        const ok = await copyText(body);
        showStatus(ok ? "Copied. Paste it into an email to support@tempqr.com." : "Copy failed. Please select and copy manually.");
      });

      form.addEventListener("submit", async function (e) {
        e.preventDefault();

        const to = (supportTo.value || "support@tempqr.com").trim();
        const { message, body } = buildPayload();

        if (!message) {
          showStatus("Please write a message.");
          msg.focus();
          return;
        }

        const subject = "TempQR Feedback";
        const mailto = "mailto:" + encodeURIComponent(to)
          + "?subject=" + encodeURIComponent(subject)
          + "&body=" + encodeURIComponent(body);

        // Attempt to open user's email app
        try {
          window.location.href = mailto;
          showStatus("If nothing opened, click “Copy message” and paste it into Gmail/Outlook.");
        } catch (err) {
          showStatus("Couldn’t open the email app. Click “Copy message” and paste it into Gmail/Outlook.");
        }
      });
    })();
  </script>
</body>
</html>
